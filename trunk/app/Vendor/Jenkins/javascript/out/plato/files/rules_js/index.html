<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - rules.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>rules.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">69.44</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">452</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">81.50</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">2.87</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/*global console, validationJS, toString, Array*/

/* 
 * Contien l&#039;équivalent des vérifications de CakePhp et des vérifications php additionnels en Javascript
 * 
 * @package app.View.Helper
 * @subpackage FormValidator
 * @license CeCiLL V2 (http://www.cecill.info/licences/Licence_CeCILL_V2-fr.html)
 */

/**
 * Si une valeur vaut undefined, lui attribu la defaultValue
 * @param {type} valeur
 * @param {type} defaultValue
 * @returns {unresolved}
 */
function giveDefaultValue( valeur, defaultValue ){
	&#039;use strict&#039;;
	return valeur === undefined ? defaultValue : valeur;
}

/**
 * Ajoute les 0 manquant si besoin (ex: 1-2-2015 =&gt; 01-02-2015)
 * @param {String} dateString
 * @returns {String}
 */ 
function zeroFillDate( dateString ){
	&#039;use strict&#039;;
	return dateString.replace( /^(\d)\-/, &#039;0$1-&#039; ).replace( /\-(\d)\-/, &#039;-0$1-&#039; ).replace( /\-(\d)$/, &#039;-0$1&#039; );
}
/* @namespace Validation */
var Validation = {
	/**
	 * Vérifi qu&#039;une chaine soit alphaNumérique (accents et charactères étranger autorisé)
	 * @param {String} value
	 * @returns {Boolean}
	 * @function Validation.alphaNumeric
	 */
	alphaNumeric: function( value ) {
		&#039;use strict&#039;;
		if ( value === undefined || value === null ){
			return false;
		}
		var test = !Array.isArray(value.match( /[!:;,§\/.?*%\^¨$£=()-+œ&lt;&gt;°@_-`\[\]\\{}#&quot;&#039;~&amp; ]|\s/g )) &amp;&amp; value.length &gt; 0;
		return test;
	},
	
	/**
	 * Alias de la function alphaNumeric()
	 * @param {String} value
	 * @returns {Boolean}
	 */
	alphanumeric: function( value ) {
		&#039;use strict&#039;;
		return Validation.alphaNumeric( value );
	},
	
	/**
	 * Vérifi qu&#039;une chaine n&#039;est pas vide (exclu retour à la ligne, tabulation et espaces)
	 * @param {String|Number} value
	 * @returns {Boolean}
	 */
	notEmpty: function( value ){
		&#039;use strict&#039;;
		if ( value === null ){
			return false;
		}
		
		value = value.replace(/\s/g, &#039;&#039;).replace(/ /g, &#039;&#039;);
		var test = value.length &gt; 0;
		return test;
	},
	
	/**
	 * Vérifi la taille d&#039;une chaine avec valeur min et max (inclu)
	 * @param {String|Number} value
	 * @param {Number} min
	 * @param {Number} max
	 * @returns {Boolean}
	 */
	between: function( value, min, max ){
		&#039;use strict&#039;;
		value = String(value).length;
		min = parseInt( min, 10 );
		max = parseInt( max, 10 );
		
		var test = value &gt;= min &amp;&amp; value &lt;= max;
		return test;
	},
	
	/**
	 * Moteur de inList()
	 * @param {String|Number} value
	 * @param {Array} array
	 * @param {String|Number} sameType
	 * @returns {Boolean}
	 */
	checkIfInList: function( value, array, sameType ){
		&#039;use strict&#039;;
		var i;
		if ( typeof toString(value) === &#039;string&#039; &amp;&amp; Array.isArray( array ) ){
			for(i=0; i&lt;array.length; i++){
				if ( (sameType &amp;&amp; value === array[i]) || (!sameType &amp;&amp; Validation.similarTo( value, array[i] )) ){
					return true;
				}
			}
		}
		return false;
	},
	
	/**
	 * Vérifi l&#039;existance de value dans array
	 * @param {String|Number} value
	 * @param {Array} array
	 * @param {String|Number} sameType
	 * @returns {Boolean}
	 */
	inList: function( value, array, sameType ){
		&#039;use strict&#039;;
		sameType = giveDefaultValue( sameType, true );
		sameType = ( sameType === &#039;f&#039; || Validation.similarTo( sameType, 0 ) || Validation.similarTo( sameType, -1 ) || Validation.similarTo( sameType, &#039;false&#039; ) || sameType === false ) ?
			false : true;
		
		return Validation.checkIfInList( value, array, sameType );
	},
	
	/**
	 * Vérifi que la valeur de value est bien entre min et max (inclu ou pas selon le dernier param) 
	 * @param {Number|Float} value
	 * @param {Number|Float} min
	 * @param {Number|Float} max
	 * @param {Boolean} inclusive
	 * @returns {Boolean}
	 */
	inRange: function( value, min, max, inclusive){
		&#039;use strict&#039;;
		min = parseFloat( giveDefaultValue( min, -Infinity ) );
		max = parseFloat( giveDefaultValue( max, Infinity ) );
		inclusive = giveDefaultValue( inclusive, true );
		value = parseFloat( value );
		
		var test = inclusive ? (value &gt;= min &amp;&amp; value &lt;= max) : (value &gt; min &amp;&amp; value &lt; max);
		return test;
	},
	
	/**
	 * Alias de la function inRange avec le param inclusive à false
	 * @param {Number|Float} value
	 * @param {Number|Float} min
	 * @param {Number|Float} max
	 * @returns {Boolean}
	 */
	range: function ( value, min, max ){
		&#039;use strict&#039;;
		return Validation.inRange( value, min, max, false );
	},
	
	/**
	 * Alias de la function inRange avec le param inclusive à true
	 * @param {Number|Float} value
	 * @param {Number|Float} min
	 * @param {Number|Float} max
	 * @returns {Boolean}
	 */
	inclusiveRange: function ( value, min, max ){
		&#039;use strict&#039;;
		return Validation.inRange( value, min, max );
	},
	
	/**
	 * Vérifi la syntaxe ssn (n° de sécu)
	 * @param {String|Number} value
	 * @returns {Boolean}
	 */
	ssn: function( value ){
		&#039;use strict&#039;;
		value = String(value);
		var test = Array.isArray(value.match( /^(1|2|7|8)[0-9]{2}(0[1-9]|10|11|12|[2-9][0-9])((0[1-9]|[1-8][0-9]|9[0-5]|2A|2B)(00[1-9]|0[1-9][0-9]|[1-8][0-9][0-9]|9[0-8][0-9]|990)|(9[7-8][0-9])(0[1-9]|0[1-9]|[1-8][0-9]|90)|99(00[1-9]|0[1-9][0-9]|[1-8][0-9][0-9]|9[0-8][0-9]|990))(00[1-9]|0[1-9][0-9]|[1-9][0-9][0-9]|)(0[1-9]|[1-8][0-9]|9[0-7])$/ ));
		return test;
	},
	
	/**
	 * Converti, si besoin, une date du format français vers le format anglais (dmy -&gt; ymd)
	 * @param {type} value
	 * @param {type} option
	 * @returns {String}
	 */
	getEnglishDate: function( value, option ){
		&#039;use strict&#039;;
		if ( option.toLowerCase() === &#039;dmy&#039; ){
			// Format de date française selon si l&#039;année est défini sur 4 chiffres ou seulement 2
			value = ( value.indexOf(&#039; &#039;, 7) &lt; 10 || value.indexOf(&#039;T&#039;) &lt; 10 ) ?
				value.substr(6,2) + value.substr(2,4) + value.substr(0,2) + value.substr(8, value.length -8) :
				value.substr(6,4) + value.substr(2,4) + value.substr(0,2) + value.substr(10, value.length -10)
			;
		}
		
		return value;
	},
	
	/**
	 * Vérifi la validitée d&#039;une date
	 * formats acceptés :
	 * YYYY-MM-DD HH:MM:SS -&gt; Format SQL
	 * YY-MM-DD -&gt; Format alternatif, rajoute 1900 si YY &gt; 70 et 2000 si YY &lt; 70 (fonctionne avec tout autre format)
	 * YYYY/MM/DD -&gt; Format standart (fonctionne pour tout autre format)
	 * YYYY.MM.DD -&gt; Format particulier (fonctionne pour tout autre format)
	 * YYYY MM DD -&gt; Format particulier (fonctionne pour tout autre format)
	 * YYYY-MM-DDTHH:MM:SS.000Z-&gt; Format Javascript (avec microsecondes)
	 * DD-MM-YYYY -&gt; Date française
	 * DD-MM-YYYY HH:MM:SS -&gt; DateTime français
	 * HH:MM:SS -&gt; Format heure
	 * 
	 * @param {Date} value
	 * @returns {Boolean}
	 */
	date: function( value, option ){
		&#039;use strict&#039;;
		option = giveDefaultValue( option, [&#039;&#039;] )[0];
		
		value = Validation.getEnglishDate( value, option );
		
		// On reformate la date pour faciliter le traitement
		value = Validation.transformIntoDate( value );
		
		// On converti la date formatté en objet javascript Date et on retransforme en chaine formaté
		var test = new Date( value ).toJSON();
		if ( test === null ){
			return false;
		}
		
		// On ne garde que les chiffres pour éviter les érreurs dû au multi-bytes
		value = value.replace(/([^0-9]?)/g, &#039;&#039;);
		test = test.replace(/([^0-9]?)/g, &#039;&#039;);
		
		// Plus qu&#039;a comparer les dates, si il y a eu un changement ou bien si ça n&#039;a pas fonctionné,
		// c&#039;est que c&#039;est une mauvaise date/syntaxe
		// PS: on vire les microsecondes qui peuvent provoquer des problèmes
		return (test.substr(0,14) === value.substr(0,14));
	},
	
	/**
	 * Ajoute les parties manquante d&#039;un dateTime (ex: 1/3/15 =&gt; 01-03-2015T00:00:00.000Z)
	 * @param {String} value
	 * @returns {String}
	 */
	completeDateTime: function( value ){
		&#039;use strict&#039;;
		// Sur la partie date, on s&#039;assure d&#039;avoir des - et non des espaces, des slash ou des points
		// La date doit ressemble à ça pour l&#039;instant : 01-03-2015 11:55:22, on met un T au milieu à la place de l&#039;espace
		value = zeroFillDate( value.substr(0,8).replace(/\.| |\//g, &#039;-&#039;) ) + value.substr(8, value.length-8).replace(&#039; &#039;, &#039;T&#039;);
		
		// Ajoute une date fictive dans le cas d&#039;un Time
		value = value.indexOf(&#039;-&#039;) &gt; 0 ? value : &#039;01-01-20T&#039; + value;
		
		// Ajoute un time fictif dans le cas d&#039;un date
		value = value.indexOf(&#039;T&#039;) &gt; 0 ? value : value + &#039;T00:00:00&#039;;
		
		// Ajoute les microsecondes si elles n&#039;existent pas
		value = value.indexOf(&#039;Z&#039;) &gt; 0 ? value : value + &#039;.000Z&#039;;
		
		return value;
	},
	
	/**
	 * Transforme si besoin, une année de 2 chiffres en 4 chiffres (ex: 15 =&gt; 2015)
	 * @param {String} value
	 * @returns {String}
	 */
	yyToyyyy: function( value ){
		&#039;use strict&#039;;
		var year = value.substr( 0, value.indexOf(&#039;-&#039;) );
		
		// Pour l&#039;année, si seul 2 chiffres sont renseigné, on ajoute 1900 ou 2000 si la valeur est inférieur ou supérieur à 30
		if( year.length === 2 &amp;&amp; value.indexOf(&#039;T&#039;) === 8 ){
			year = year &gt;= 30 ? &#039;19&#039; + year : &#039;20&#039; + year;
		}
		
		return year;
	},
	
	/**
	 * Reformate la date au format yyyy-mm-ddThh:mm:ss.mmmZ
	 * @param {String} value
	 * @returns {String}
	 */
	transformIntoDate: function ( value ){
		&#039;use strict&#039;;
		var pos;
		if ( Validation.similarTo( value, null ) ) {
			return false;
		}
		
		value = Validation.completeDateTime( value );
		
		pos = value.indexOf(&#039;-&#039;);
		value = Validation.yyToyyyy( value ) + value.substr( pos );
				
		// Traitements date française JJ-MM-YYYY
		if ( value.indexOf(&#039;-&#039;) === 2 ){
			value = value.substr(6,4) + value.substr(2,4) + value.substr(0,2) + value.substr(10,value.length -10);
		}
		
		return value;
	},
	
	/**
	 * Alias de la function date
	 * @param {String} value
	 * @returns {Boolean}
	 */
	dateTime: function( value ){
		&#039;use strict&#039;;
		return Validation.date( value );
	},
	
	/**
	 * Vérifi la syntaxe d&#039;un numéro de téléphone en france
	 * @param {String|Number} value
	 * @returns {Boolean}
	 */
	phoneFr: function( value ){
		&#039;use strict&#039;;
		value = String(value);
		value = value.length === 9 ? &#039;0&#039; + value : value;
		value = value.replace(/ /g, &#039;&#039;).replace(/\./g, &#039;&#039;);
		
		var test = Array.isArray(value.match(/^(((0)[1-9](\s?\d{2}){4})|(1[0-9]{1,3})|(11[0-9]{4})|(3[0-9]{3}))$/));
		
		return test;
	},
	
	/**
	 * Vérifi la synthaxe d&#039;une adresse email
	 * @param {type} value
	 * @returns {Boolean}
	 */
	email: function( value ){
		&#039;use strict&#039;;
		var test = Array.isArray(value.match(/^[a-z0-9!#$%&amp;\&#039;*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&amp;\&#039;*+\/=?\^_`{|}~\-]+)*@(?:[\-_a-z0-9][\-_a-z0-9]*\.)*(?:[a-z0-9][\-a-z0-9]{0,62})\.(?:(?:[a-z]{2}\.)?[a-z]{2,})$/i));
		return test;
	},
	
	/**
	 * Vérifi qu&#039;un champ possède une valeur de type integer
	 * @param {Number} value
	 * @returns {Boolean}
	 */
	integer: function ( value ){
		&#039;use strict&#039;;
		var test = ( !isNaN(value) &amp;&amp; value % 1 === 0 &amp;&amp; value !== null );
		return  test;
	},
	
	/**
	 * Vérifi qu&#039;un champ possède une valeur de type boolean
	 * @param {Number|Boolean} value
	 * @returns {Boolean}
	 */
	boolean: function ( value ){
		&#039;use strict&#039;;
		var test = Validation.inList( value, [0, 1, &#039;0&#039;, &#039;1&#039;, &#039;true&#039;, &#039;false&#039;, true, false] );
		return test;
	},
	
	/**
	 * Vérifie que le contenu de la liste d&#039;id est vide
	 * @param {Array} value
	 * @returns {Boolean}
	 */
	allEmpty: function ( value ){
		&#039;use strict&#039;;
		var i;
		if ( !Array.isArray(value) ){
			return false;
		}
		
		for (i=0; i&lt;value.length; i++) {
			if ( value[i] !== null &amp;&amp; value[i].length &gt; 0 ){
				return false;
			}
		}
		return true;
	},
	
	/**
	 * Renvoi true si l&#039;input indiqué dans &quot;idInputTest&quot; n&#039;est pas vide ou
	 * si l&#039;input indiqué par &quot;fieldName&quot; possède ou pas (&quot;condition&quot;) une valeur
	 * contenu dans &quot;valeurs&quot;
	 * @param {String} value
	 * @param {String} fieldName
	 * @param {Boolean} condition
	 * @param {Array} valeurs
	 * @returns {Boolean}
	 */
	notEmptyIf: function ( value, targetValue, condition, valeurs ){
		&#039;use strict&#039;;
		if ( Validation.similarTo( value, null ) || Validation.similarTo( targetValue, null ) || Validation.similarTo( condition, null ) || Validation.similarTo( valeurs, null ) || !Array.isArray( valeurs ) ) {
			return false;
		}
		
		if ( Validation.inList( targetValue, valeurs ) === condition ){
			return Validation.notEmpty( value );
		}		
		return true;
	},
	
	/**
	 * Compare deux dates selon l&#039;operateur de comparaison
	 * @param {String} date1
	 * @param {String} date2
	 * @param {String} operateur
	 * @returns {Boolean}
	 */
	compareDates: function( date1, date2, operateur ){
		&#039;use strict&#039;;
		
		switch ( operateur ) {
			case &#039;&lt;&#039;: return date1 &lt; date2;
			case &#039;&gt;&#039;: return date1 &gt; date2;
			case &#039;&lt;=&#039;: return date1 &lt;= date2;
			case &#039;&gt;=&#039;: return date1 &gt;= date2;
			case &#039;==&#039;: return Validation.similarTo(date1.toJSON(), date2.toJSON());
			case &#039;!=&#039;: return !Validation.similarTo(date1.toJSON(), date2.toJSON());
			case &#039;===&#039;: return date1.toJSON() === date2.toJSON();
			case &#039;!==&#039;: return date1.toJSON() !== date2.toJSON();
			default: return false;
		}
	},
	
	/**
	 * Inutile en javascript donc renvoi vers notEmptyIf 
	 * @param {String} value
	 * @param {String} fieldName
	 * @param {Boolean} condition
	 * @param {Array} valeurs
	 * @returns {Boolean}
	 */
	notNullIf: function ( idInputTest, idInputMaitre, condition, valeurs ) { 
		&#039;use strict&#039;;
		return Validation.notEmptyIf( idInputTest, idInputMaitre, condition, valeurs );
	},
	
	/**
	 * Vérifi que le nombre de char de value ne dépasse pas maxLength 
	 * @param {String} value
	 * @param {Numeric} maxLength
	 * @returns {Boolean}
	 */
	maxLength: function ( value, maxLength ){
		&#039;use strict&#039;;
		value = value === undefined || value === null ? 0 : value;
		var test = value.length &lt;= maxLength;
		return test;
	},
	
	/**
	 * Converti les params en String avant de les comparer
	 * 
	 * @param {String|Numeric} first
	 * @param {String|Numeric} last
	 * @returns {Boolean}
	 */
	similarTo: function ( first, last ){
		&#039;use strict&#039;;
		return String(first) === String(last);
	}
};</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
